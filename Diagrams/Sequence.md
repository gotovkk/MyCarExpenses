## 4. Диаграммы последовательности

**Назначение:**

Диаграммы последовательности (Sequence Diagrams) показывают, как объекты системы взаимодействуют друг с другом во времени для выполнения конкретного сценария. Они детализируют диаграммы активностей, фокусируясь не на потоке работы, а на обмене сообщениями (вызовах методов) между объектами.

### 4.1 Последовательность: Регистрация нового пользователя
<img width="1280" height="636" alt="изображение" src="https://github.com/user-attachments/assets/e7ff6cf5-ca2f-4bd8-8c73-02acd4ef0444" />

Диаграмма показывает взаимодействие между `:Пользователем`, клиентским приложением (`:WebAppClient`), менеджером аутентификации (`:AuthManager`) и базой данных (`:Database`). Она наглядно демонстрирует, как вызов `register_user` инициирует проверку в БД. Блок `alt` (альтернатива) используется для моделирования двух исходов: успешной регистрации с созданием нового объекта `:User` и хешированием пароля, либо ошибки, если email уже занят.

### 4.2 Последовательность: Добавление нового расхода
<img width="1280" height="539" alt="изображение" src="https://github.com/user-attachments/assets/8290f824-8ac4-4a16-a462-6c1a82cd51f4" />

Эта диаграмма иллюстрирует вызовы методов при добавлении расхода. `:WebAppClient` обращается к `:ExpenseManager`, который сначала валидирует данные, затем создает новый объект `:Expense` и передает его в `:Database` для сохранения. Эта последовательность проста и линейна, что отражает прямолинейность данного бизнес-процесса.

### 4.3 Последовательность: Просмотр аналитики
<img width="1280" height="413" alt="изображение" src="https://github.com/user-attachments/assets/dc21e2ae-63c1-43fc-8672-6f4da361c580" />

Здесь показан процесс получения и обработки данных для отчета. `:WebAppClient` запрашивает отчет у `:ExpenseManager`. Тот, в свою очередь, делает один запрос к `:Database` для получения "сырого" списка расходов за период. Далее, с помощью блока `loop`, показан внутренний процесс агрегации этих данных, после которого готовый отчет в формате JSON возвращается клиенту для отображения.
